---
id: 
title: Atomic Cross-Rollup Arbitrage via  Coordinator and State Lock Auctions
team: AJ | Radius
created: 2025-04-29
---

# Atomic Cross-Rollup Arbitrage via  Coordinator and State Lock Auctions

## Summary

This Flashbots Research Proposal (FRP) introduces a mechanism for achieving **atomic cross-rollup arbitrage** between rollups (e.g. Optimism Mainnet and Base) by leveraging a **shared infra** coordinating with both rollups’ sequencers. Our hypothesis is that a coordinator employing **state lock auctions** (as proposed by [*State Lock Auctions – Towards Collaborative Block Building*](https://ethresear.ch/t/state-lock-auctions-towards-collaborative-block-building/18558)), can orchestrate cross-domain MEV bundles that execute atomically (all-or-nothing) across two rollups. This would eliminate the risks inherent to today’s non-atomic, asynchronous arbitrage strategies while preserving overall throughput and fairness on each rollup.

In the proposed design, the coordinator runs an **open auction for state locks** on the relevant portions of each rollup’s state that the arbitrage transactions (`tx_A` on Rollup A and `tx_B` on Rollup B) will touch. Searchers bid for the exclusive right to atomically execute an arbitrage across both domains (or either of them separately). The highest bidder’s bundle is granted locks on those state segments on each rollup for the next block, and their transactions are inserted (by the sequencers in coordination with the builder) into each rollup’s block such that either both execute or neither does. This **cross-domain state locking** mechanism ensures no other transaction can interfere with the targeted Uniswap pools or other contracts during the lock, enabling **atomic execution**: the arbitrage executes in full on both rollups or not at all. The coordinator collects the bids as fees, creating a new revenue model aligned with MEV extraction.

Our methodology will involve designing and prototyping this coordinating protocol, using [**EIP-2930 access lists**](https://eips.ethereum.org/EIPS/eip-2930) and **Trusted Execution Environments (TEEs)** to manage state access and transaction privacy. Access lists allow the searcher’s transactions to explicitly declare which addresses and storage slots they will access, which the builder uses to know exactly which state to lock on each rollup. TEEs (enclaves) will be used so that searchers can submit their arbitrage transactions privately; the enclave can output the access list (state summary) for auction without revealing the transaction’s details, providing **secure and transparent extraction of access lists**. We will evaluate limitations such as pricing the state lock (to deter abuse) and ensuring liveness/censorship-resistance.

If successful, this approach has significant implications: it would **mitigate slippage and race conditions** in cross-rollup trading, reduce wasted gas on reverted cross-chain arbitrage attempts, and unlock more efficient price alignment between rollups without requiring full L1 synchronization. It extends the state-of-the-art in MEV auction design (per prior [single-domain state lock proposals](https://collective.flashbots.net/t/state-lock-auctions-towards-collaborative-block-building/3019)) to a multi-domain context, potentially informing the design of future **shared sequencing protocols** for atomic cross-chain execution. By coordinating two otherwise independent sequencers via a market mechanism, we hypothesize that cross-domain MEV can be captured securely **without degrading throughput** on either chain. This proposal outlines the motivation, design, and research plan to validate this mechanism, including a representative use case of a Uniswap arbitrage between Optimism and Base.

![flow diagram](Atomic%20Cross-Rollup%20Arbitrage%20_1.png)

## Background and Problem Statement

**Cross-Rollup Arbitrage Today:** With the rise of multiple Layer-2 rollups, liquidity and trading opportunities are fragmented across domains. Price discrepancies frequently arise between equivalent pools on different rollups (e.g. a WETH/USDC pair on Optimism vs the same pair on Base), offering arbitrage opportunities. However, **executing an arbitrage across two rollups is currently non-atomic and asynchronous**. A trader must typically execute one leg of the trade on one rollup, then *separately* execute the second leg on the other rollup, often by listening for an event or using a relayer to trigger the second transaction. There is no guarantee both legs succeed or that they occur back-to-back. In practice, this **lack of atomicity** introduces several problems:

- **Execution Risk & Slippage:** If one leg of the arbitrage executes without the other, the arbitrageur is left with an unhedged position. For example, they might buy token A on Optimism expecting to sell it on Base, but if the Base transaction fails, they now hold extra token A and could incur a loss if its price moves. Even if both eventually execute, the price on the second rollup may have slipped by the time of execution, eroding profits or causing a revert due to slippage limits.
- **Latency and Race Conditions:** Asynchronous cross-chain trades have inherent latency – the time it takes to confirm the first transaction and relay a message to start the second. During this delay, market conditions can change or competing arbitrage bots can react. This often forces arbitrageurs to **“race”** to be faster than competitors and price movements, or to inflate their bids to outpace others in each domain’s mempool. High latency lowers the chance of successfully capturing the price discrepancy.
- **Solver/Relayer Exposure:** Because atomic execution isn’t available, traders sometimes rely on third-party “solvers” or fast relayers to execute the second leg upon seeing the first leg. This exposes the strategy to those parties – who might front-run or censor the trade – and adds complexity and trust assumptions. In essence, arbitrageurs must reveal their intent to some extent (via the first transaction or via coordination with a relayer), inviting adversarial interference.
- **Inefficient Execution (Reverts & Cost):** Many cross-domain arbitrage attempts result in one transaction reverting if the other leg fails or if the opportunity vanishes. Searchers often compensate by shotgun submitting many transactions or cancels, accepting that most will revert. This leads to **wasted block space and gas**. Recent research indicates that on L2s, a huge number of arbitrage opportunities remain unexploited or delayed due to these difficulties. In fact, a majority of arbitrage volume in Ethereum and L2 ecosystems comes from such non-atomic (cross-domain or CEX-DEX) arbitrage, which carries these inefficiencies.

Overall, the current state-of-the-art for cross-rollup arbitrage is suboptimal. Liquidity remains fragmented because there is no secure, fast way to unify price action across rollups the way arbitrage on a single chain can unify prices between DEXes. The **motivation** for this proposal is to remove the uncertainty and risk from cross-rollup arbitrage by making it *atomic*: either both trades execute in lockstep or none do. If arbitrageurs can rely on atomic execution, they can confidently take larger positions with lower risk premiums, leading to tighter price alignment between rollups and more efficient markets.

**Towards Atomic Cross-Rollup Execution:** Achieving atomicity across different chains or rollups is challenging because each domain has its own independent sequencer and block production. A naive solution is a **shared infra** that orders transactions for multiple rollups together. ( Shared sequencer as envisioned in the Optimism “Superchain” roadmap) Indeed, Optimism developers have noted that *“synchronous cross-chain messaging and atomic cross-chain interactions”* could be enabled by a **shared sequencing protocol** operating on both chains. In such a design, the sequencers of chain A and chain B would coordinate on including a cross-chain bundle in the same block on both sides, and only charge fees if both transactions are included successfully[.](https://docs.optimism.io/superchain/superchain-explainer) This concept shifts the synchronization risk away from the user and requires the sequencers to come to consensus on cross-domain orderings.

However, full shared sequencing requires significant changes to the rollup protocol and consensus, and may introduce complexity or new failure modes if not carefully designed. In the interim (and even as a complement to shared sequencing), we propose a more **incremental, builder-centric approach**: use a *coordinator* that works with existing sequencers to mimic atomic inclusion through MEV techniques. In Ethereum’s Proposer-Builder Separation (PBS) model, block builders assemble blocks given user transactions and bids. We extend this concept across chains by introducing a coordinator that can assemble **two blocks (one per rollup) with a synchronized arbitrage bundle** in them. Crucially, we employ the idea of [**state lock auctions**](https://ethresear.ch/t/state-lock-auctions-towards-collaborative-block-building/18558) to ensure that the arbitrage bundle can execute without interference on both chains.

**State Lock Auctions (Single-Domain Recap):** The concept of state lock auctions was recently proposed by Flashbots researchers as a way to manage high-frequency, single-tx arbitrages at the top of blocks. Instead of searchers privately bribing block builders or sequencers with opaque bids (leading to a vertical integration arms race), the idea is to create an open auction for the right to “lock” specific portions of the state for exclusive use in the next block. In this model, searchers submit a bid along with a description of *which state* their transaction will touch (an **access list**), and if they win, that transaction is guaranteed to be executed affecting that state, while no other transaction in that block can touch it.

This mechanism has been sketched out for a **single domain (one block)** context. Our insight is that we can extend *state lock auctions to multiple domains (two rollups) simultaneously*. The **problem statement** we address is: *Can we enable atomic arbitrage across two rollups by coordinating their block production through a coordinator that locks the relevant state on each rollup via auction?* We need to ensure that this can be done **without protocol-level changes** to the rollups (leveraging existing mechanisms like block building and access lists), and that it **does not degrade the normal operations** of each rollup beyond the specific state segments being locked for arbitrage. We also need to ensure the solution is economically sound (profitable for participants) and secure (no new vectors for abuse beyond acceptable levels).

In summary, the goal is to research and develop a mechanism where the **highest-value cross-rollup arbitrage bundle is executed atomically**, with the blessing of both rollup sequencers, and all other arbitrageurs or conflicting transactions are excluded from those particular state areas for that block. By doing so, we hope to drastically improve upon the non-atomic arbitrage model (eliminating its drawbacks like slippage and latency race) and to pave the way for more **unified liquidity across different rollups**. This proposal will explore the design in detail and answer open questions such as: How to run a dual-chain state auction efficiently? How to split the payment between two chains’ proposers? What are the failure modes (e.g. one side of the trade reverting) and how to handle them? How to prevent denial-of-service or griefing by bidding to lock state on multiple chains without intention to execute? The following sections outline our approach to tackling these questions and the deliverables we plan to produce.

![flow diagram](Atomic%20Cross-Rollup%20Arbitrage%20_2.png)

## Plan and Deliverables

**Research topics**
- Architecture to guarantee synchronous composability with state lock auctions between multiple rollups
- Algorithm to re-distribute arb profits among multiple rollups

**Research Plan:** We will approach the problem in phases, iteratively refining the design and validating its feasibility:

- **Phase 1: Mechanism Design and Theoretical Analysis.** In this initial phase, we will formalize the cross-rollup state lock auction mechanism. This includes specifying the message flows between searchers, the shared coordinator (auctioneer), and the two rollup sequencers.
- **Phase 2: Prototyping and Simulation.** In this phase, we will implement a proof-of-concept of the shared builder and auction system. This will likely involve a simplified environment.
- **Phase 3: Evaluation and Iteration.** Using the insights from the prototype, we will evaluate the feasibility and impact of deploying such a system in practice.
- **Phase 4: Outreach and Implementation Plan (Optional/Future Work).** Finally, while not the core focus of this research proposal, we will outline a path to implement this mechanism on mainnet rollups if the results are promising.

### **Representative Use Case**

**Cyclic Arbitrage between Uniswap on Optimism and Base:** To make the discussion concrete, we illustrate the mechanism with a specific example that will also serve as a test scenario in our prototype. Suppose there is a price discrepancy for ETH/USDC between Uniswap v3 on Optimism and Uniswap v3 on Base. On Optimism, 1 ETH might be trading for 1800 USDC, while on Base it’s 1820 USDC. A searcher can profit by selling USDC for ETH on Optimism (acquire ETH cheaply) and simultaneously selling that ETH for USDC on Base (for a higher price), effectively moving USDC from Base to Optimism and ETH from Optimism to Base in value terms.

In a non-atomic setting, the searcher might try to do the Optimism trade first, then bridge or otherwise use a relay to do the Base trade. They risk that by the time the Base trade happens, someone else has arbitraged or the price moved (maybe Base price dropped to 1805, making the trade less profitable or even a loss after fees). With our coordinator the searcher instead submits the two transactions as an atomic bundle:

- `tx_A` (Optimism): Swap USDC → ETH in Uniswap (Optimism), up to e.g. 1 million USDC.
- `tx_B` (Base): Swap ETH → USDC in Uniswap (Base) for the amount of ETH obtained in `tx_A`.

They include in their bid the **access lists** for each transaction. For instance, `tx_A` will touch the USDC token contract (for balances) and the Optimism Uniswap pool contract’s storage (for reserves, etc.), and `tx_B` will touch the Base Uniswap pool and possibly the same token contracts on Base. These addresses and specific storage slots (like the pool’s reserve slots) are listed in the access list. The searcher’s bid `b` represents how much value they are willing to pay to ensure this executes atomically (likely a fraction of the arbitrage profit). Competing searchers might compute slightly different optimal amounts or see slightly different prices, leading to different profit estimates and bids. All submit to the builder’s auction. Let’s say our searcher wins with a bid of 5,000 USDC (meaning that’s the profit share they’ll give up). The builder now *locks* the state of those two Uniswap pools on both rollups. At the designated block height, Optimism’s sequencer includes `tx_A` (which will execute against the pool’s state) and Base’s sequencer includes `tx_B` in the same block time. Because the state is locked, we guarantee no other transaction on Optimism touched the ETH/USDC pool earlier in that block, and similarly on Base. Thus, the price at execution is exactly as expected when the searcher priced the trade. Both swaps execute successfully, converting, say, 1,000,000 USDC on Optimism into ~555 ETH, and then converting ~555 ETH on Base into ~1,010,000 USDC (numbers for illustration). The arbitrage yields a profit of ~10,000 USDC. From this, the searcher pays 5,000 USDC as the bid fee: this is accomplished by the builder having included a `tx_payment_A` on Optimism (which could transfer, say, 2,500 USDC worth of ETH to the sequencer’s fee address) and a `tx_payment_B` on Base (transferring the other 2,500 USDC to that sequencer). The searcher nets 5,000 USDC profit (minus whatever gas fees), and the sequencers collectively earn 5,000 USDC (value) extra for facilitating the atomic block. If another searcher had a better strategy or was willing to pay more (maybe they had some private order giving even better price, etc.), they could have won the auction – but in any case, only one bundle executes, avoiding redundant or conflicting transactions.

This example demonstrates how, from the user’s perspective, the arbitrage is **atomic** – they wouldn’t do the second swap without the first. From each rollup’s perspective, they just see a high-value transaction in the block (plus a payment) that was pre-arranged via the off-chain builder. No rollup had to halt or wait excessively; the coordination happened in the background via the builder’s auction. The outcome is successful arbitrage that closes the price gap between Optimism and Base almost instantaneously, which is beneficial for all users of those ecosystems (prices reflect global liquidity). Our proposal aims to generalize and formalize this process, addressing all the edge cases so that it could be deployed in practice.

By connecting this use case back to the broader context, we stress that our mechanism builds upon prior MEV research (especially the concept of *locking state via auctions*) and adapts it to the emerging multi-rollup environment. If proven out, this could serve as a template for **collaborative cross-domain block building** – an approach where independent block producers work together to maximize total value extraction and user outcomes, rather than operating in silos where arbitrage is fragmentary. It is a stepping stone toward the vision of unified DeFi across rollups, and could inform both interim solutions and long-term protocol designs.

## References
- **State Lock Auctions** [ethresear.ch](https://ethresear.ch/t/state-lock-auctions-towards-collaborative-block-building/18558)
- **EIP-2930: Optional Access Lists** [eips.ethereum.org](https://eips.ethereum.org/EIPS/eip-2930)
- **Optimism Superchain Shared Sequencing** [docs.optimism.io](https://docs.optimism.io/superchain/superchain-explainer)
- **Gogol et al., "Non-Atomic Arbitrage Across L2 Blockchains" (2024)** [arxiv.org](https://arxiv.org/pdf/2406.02172)
- ***Trustless Interoperability between Rollups by 1kx*** [medium.com] (https://medium.com/1kxnetwork/trustless-interoperability-between-rollups-landscape-constructions-and-challenges-8ff195ea92cc)